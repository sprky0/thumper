<!DOCTYPE html>
<html>
<head>
	<style>

html, body {
	margin: 0;
	padding: 0;
}

.off {
	background-color: green;
	color: red;
}

.on {
	background-color: red;
	color: green;
}

button {
	border-radius: 0;
	padding: 100px;
}

	</style>
</head>
<body>

<div id="indicator" class="off"><p id="bpm">?</p></div>

<button id="tap">TAP</button>
<button id="tap-start">TAP-START</button>
<button id="tap-start">START (RESET)</button>
<button id="stop-continue">STOP | CONTINUE</button>

<script>

	function thumper() {

		var bpm = document.getElementById('bpm');
		var buttonTap = document.getElementById('tap');
		var buttonTapStart = document.getElementById('tap-start');
		var stopContinue = document.getElementById('stop-continue');
		var timer = setInterval(interval,1);

		buttonTap.addEventListener('click', tap);

		var _BPM = -1;
		var _MSB = -1;
		var thent = 0;
		var theni = 0;
		var partyPals = [];
		var maxPartyPals = 3;

		function interval() {

			var now = new Date().getTime();
			var diff = now - theni;

			if (diff > (_MSB / 2)) {
				bpm.classList.add('off');
				bpm.classList.remove('on');
			}

			if (diff > _MSB) {
				theni = now;
				bpm.innerHTML = _BPM;
				bpm.classList.add('on');
				bpm.classList.remove('off');
			}

		}

		function tap(e) {

			var now = new Date().getTime();

			partyPals.push(now - thent);

			while (partyPals.length > maxPartyPals) {
				partyPals.shift();
			}

			var avg = 0;

			for(var i = 0; i < partyPals.length; i++) {
				avg += partyPals[i];
			}

			avg = avg / partyPals.length;

			console.log(avg);
			console.log(partyPals);

			_BPM = (60 * 1000) / avg;
			_MSB = avg;

			console.log(_MSB);
			console.log(_BPM);

			thent = now;

		}

	} // thumper constructor

</script>

</body>
</html>
